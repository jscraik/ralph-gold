# Ralph Gold configuration
#
# Safe defaults:
# - branch_strategy = "none"
# - auto_commit = false
# - everything stays in .ralph/

[loop]
max_iterations = 50
no_progress_limit = 3
rate_limit_per_hour = 0
sleep_seconds_between_iters = 0
runner_timeout_seconds = 900

# Backstop: mark a task BLOCKED after N failed attempts (0 disables)
max_attempts_per_task = 3
skip_blocked_tasks = true

[files]
prd = ".ralph/PRD.md"
progress = ".ralph/progress.md"
agents = ".ralph/AGENTS.md"
prompt = ".ralph/PROMPT_build.md"
plan = ".ralph/PROMPT_plan.md"
judge = ".ralph/PROMPT_judge.md"
review = ".ralph/PROMPT_review.md"
feedback = ".ralph/FEEDBACK.md"
specs_dir = ".ralph/specs"

[tracker]
# auto|markdown|json|beads|yaml|github_issues
kind = "auto"

[git]
# none|per_prd|task
branch_strategy = "none"
base_branch = ""
branch_prefix = "ralph/"

auto_commit = false
commit_message_template = "ralph: {story_id} {title}"
amend_if_needed = true

[gates]
# Extra gate commands (run after prek if enabled)
commands = []

[gates.prek]
# Optional: use prek as your universal gate runner.
# It reads .pre-commit-config.yaml but does not require installing hooks.
enabled = false
argv = ["prek", "run", "--all-files"]

[gates.review]
# Cross-model review gate. Must output a final line: SHIP or BLOCK.
enabled = false
backend = "repoprompt"   # repoprompt|runner
agent = "claude"         # used when backend=runner
required_token = "SHIP"
max_diff_chars = 30000
prompt = ".ralph/PROMPT_review.md"

[gates.llm_judge]
# Optional: legacy LLM-as-judge quality gate.
enabled = false
agent = "claude"
prompt = ".ralph/PROMPT_judge.md"
max_diff_chars = 30000

[repoprompt]
# Repo Prompt integration (rp-cli).
enabled = false
required = false
cli = "rp-cli"
# window_id = 1
# tab = "Ralph Gold"
# workspace = "MyProject"
builder_type = "clarify"
# copy_preset = "MCP Agent"
timeout_seconds = 300
fail_open = true

[parallel]
enabled = false
max_workers = 3
worktree_root = ".ralph/worktrees"
strategy = "queue"       # queue|group
merge_policy = "manual"  # manual|auto_merge

[runners.codex]
argv = ["codex", "exec", "--full-auto", "-"]

[runners.claude]
argv = ["claude", "--output-format", "stream-json", "-p"]

[runners.copilot]
argv = ["gh", "copilot", "suggest", "--type", "shell", "--prompt"]
